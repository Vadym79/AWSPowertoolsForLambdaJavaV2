<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>software.amazonaws.example</groupId>
  <artifactId>aws-lambda-graalvm-23-native-image-powertools-observability</artifactId>
  <packaging>${packaging}</packaging>
  <version>1.0.0-SNAPSHOT</version>
  <profiles>
    <profile>
      <id>native</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-shade-plugin</artifactId>
            <version>3.6.0</version>
            <executions>
              <execution>
                <phase>package</phase>
                <goals>
                  <goal>shade</goal>
                </goals>
                <configuration>
                  <transformers>
                    <transformer>
                      <mainClass>com.amazonaws.services.lambda.runtime.api.client.AWSLambda</mainClass>
                    </transformer>
                  </transformers>
                  <shadedArtifactAttached>true</shadedArtifactAttached>
                </configuration>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.graalvm.buildtools</groupId>
            <artifactId>native-maven-plugin</artifactId>
            <version>0.10.5</version>
            <extensions>true</extensions>
            <executions>
              <execution>
                <id>build-native</id>
                <phase>package</phase>
                <goals>
                  <goal>build</goal>
                </goals>
                <configuration>
                  <skip>false</skip>
                  <buildArgs>
                    <buildArg>--enable-http</buildArg>
                    <buildArg>--no-fallback</buildArg>
                    <buildArg>-H:ReflectionConfigurationFiles=./src/main/reflect.json</buildArg>
                  </buildArgs>
                  <classpath>
                    <param>/home/ec2-user/environment/AWSPowertoolsForLambdaJavaV2/lambda-graalvm-23-native-image-observability/target/aws-lambda-graalvm-23-native-image-powertools-observability-1.0.0-SNAPSHOT-shaded.jar</param>
                  </classpath>
                </configuration>
              </execution>
            </executions>
            <configuration>
              <skip>false</skip>
              <buildArgs>
                <buildArg>--enable-http</buildArg>
                <buildArg>--no-fallback</buildArg>
                <buildArg>-H:ReflectionConfigurationFiles=./src/main/reflect.json</buildArg>
              </buildArgs>
              <classpath>
                <param>/home/ec2-user/environment/AWSPowertoolsForLambdaJavaV2/lambda-graalvm-23-native-image-observability/target/aws-lambda-graalvm-23-native-image-powertools-observability-1.0.0-SNAPSHOT-shaded.jar</param>
              </classpath>
            </configuration>
          </plugin>
          <plugin>
            <groupId>dev.aspectj</groupId>
            <artifactId>aspectj-maven-plugin</artifactId>
            <version>1.14</version>
            <executions>
              <execution>
                <goals>
                  <goal>compile</goal>
                </goals>
                <configuration>
                  <source>21</source>
                  <target>21</target>
                  <complianceLevel>21</complianceLevel>
                  <aspectLibraries>
                    <aspectLibrary>
                      <groupId>software.amazon.lambda</groupId>
                      <artifactId>powertools-tracing</artifactId>
                    </aspectLibrary>
                    <aspectLibrary>
                      <groupId>software.amazon.lambda</groupId>
                      <artifactId>powertools-logging</artifactId>
                    </aspectLibrary>
                    <aspectLibrary>
                      <groupId>software.amazon.lambda</groupId>
                      <artifactId>powertools-metrics</artifactId>
                    </aspectLibrary>
                  </aspectLibraries>
                </configuration>
              </execution>
            </executions>
            <dependencies>
              <dependency>
                <groupId>org.aspectj</groupId>
                <artifactId>aspectjtools</artifactId>
                <version>1.9.22.1</version>
                <scope>compile</scope>
              </dependency>
            </dependencies>
            <configuration>
              <source>21</source>
              <target>21</target>
              <complianceLevel>21</complianceLevel>
              <aspectLibraries>
                <aspectLibrary>
                  <groupId>software.amazon.lambda</groupId>
                  <artifactId>powertools-tracing</artifactId>
                </aspectLibrary>
                <aspectLibrary>
                  <groupId>software.amazon.lambda</groupId>
                  <artifactId>powertools-logging</artifactId>
                </aspectLibrary>
                <aspectLibrary>
                  <groupId>software.amazon.lambda</groupId>
                  <artifactId>powertools-metrics</artifactId>
                </aspectLibrary>
              </aspectLibraries>
            </configuration>
          </plugin>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>versions-maven-plugin</artifactId>
            <version>2.2</version>
          </plugin>
          <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.2-beta-5</version>
            <executions>
              <execution>
                <id>native-zip</id>
                <phase>package</phase>
                <goals>
                  <goal>single</goal>
                </goals>
                <inherited>false</inherited>
                <configuration>
                  <finalName>function</finalName>
                  <descriptors>
                    <descriptor>src/assembly/native.xml</descriptor>
                  </descriptors>
                </configuration>
              </execution>
            </executions>
            <configuration>
              <finalName>function</finalName>
              <descriptors>
                <descriptor>src/assembly/native.xml</descriptor>
              </descriptors>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
  <repositories>
    <repository>
      <id>central</id>
      <url>https://repo.maven.apache.org/maven2</url>
    </repository>
    <repository>
      <id>pt-snapshots</id>
      <url>https://aws.oss.sonatype.org/content/repositories/snapshots</url>
    </repository>
  </repositories>
  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>software.amazon.awssdk</groupId>
        <artifactId>bom</artifactId>
        <version>2.30.30</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>
  <properties>
    <powertools.version>2.0.0-SNAPSHOT</powertools.version>
    <maven.compiler.target>21</maven.compiler.target>
    <release.version>21</release.version>
    <maven.compiler.source>21</maven.compiler.source>
    <versions-maven-plugin.version>2.2</versions-maven-plugin.version>
    <packaging>jar</packaging>
    <aspectj.version>1.9.22.1</aspectj.version>
    <jdk.version>21</jdk.version>
  </properties>
</project>
